# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê - –î–ò–°–ö –ü–ï–†–ï–ü–û–õ–ù–ï–ù!

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

```
OSError: [Errno 28] No space left on device
sqlite3.OperationalError: database or disk is full
```

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ!** –õ–æ–≥–∏ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –≤—Å–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.

---

## üöÄ –°–†–û–ß–ù–û–ï –†–ï–®–ï–ù–ò–ï (2 –º–∏–Ω—É—Ç—ã)

### 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏:

```bash
ssh root@80.92.204.27
cd /opt/telegram-post-copier

# –°–∫–∞—á–∞–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥
git pull origin main

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
bash EMERGENCY_DISK_CLEANUP.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- ‚úÖ –û—á–∏—Å—Ç–∏—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Docker –æ–±—Ä–∞–∑—ã –∏ volumes
- ‚úÖ –£–¥–∞–ª–∏—Ç –ª–æ–≥–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- ‚úÖ –û—á–∏—Å—Ç–∏—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ (journalctl)
- ‚úÖ –£–¥–∞–ª–∏—Ç —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –û—á–∏—Å—Ç–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ –û—á–∏—Å—Ç–∏—Ç APT –∫–µ—à

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ

### –î–æ –æ—á–∏—Å—Ç–∫–∏:
```bash
df -h
```

### –ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:
–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

## üîÑ –ó–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏

```bash
# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ —Å –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π (—Å —Ä–æ—Ç–∞—Ü–∏–µ–π –ª–æ–≥–æ–≤)
docker-compose build --no-cache

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs -f --tail 50
```

---

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤:

```python
from logging.handlers import RotatingFileHandler

# –†–æ—Ç–∞—Ü–∏—è: –º–∞–∫—Å 10MB –Ω–∞ —Ñ–∞–π–ª, —Ö—Ä–∞–Ω–∏—Ç—å 5 —Ñ–∞–π–ª–æ–≤ = –º–∞–∫—Å 50MB
file_handler = RotatingFileHandler(
    'logs/copier.log',
    maxBytes=10*1024*1024,  # 10 MB
    backupCount=5  # –•—Ä–∞–Ω–∏—Ç—å 5 —Ñ–∞–π–ª–æ–≤
)
```

**–¢–µ–ø–µ—Ä—å –ª–æ–≥–∏ –Ω–µ –±—É–¥—É—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ —Ä–∞—Å—Ç–∏!**

---

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ù–∞–π—Ç–∏ —Å–∞–º—ã–µ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã:

```bash
du -h /opt/telegram-post-copier | sort -rh | head -20
du -h /var/lib/docker | sort -rh | head -20
```

### –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ –≤—Ä—É—á–Ω—É—é:

```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
rm -f /opt/telegram-post-copier/logs/*.log*

# –õ–æ–≥–∏ Docker
docker system prune -af --volumes

# –õ–æ–≥–∏ systemd
journalctl --vacuum-time=1d
```

---

## üõ°Ô∏è –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞

### –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É (cron):

```bash
# –û—Ç–∫—Ä—ã—Ç—å crontab
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É (–æ—á–∏—Å—Ç–∫–∞ –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 3:00)
0 3 * * 0 cd /opt/telegram-post-copier && bash EMERGENCY_DISK_CLEANUP.sh >> /var/log/cleanup.log 2>&1
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç

- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `EMERGENCY_DISK_CLEANUP.sh`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ: `df -h`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥: `git pull origin main`
- [ ] –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å: `docker-compose build --no-cache`
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å: `docker-compose up -d`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É: `docker-compose logs -f`
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫—É —á–µ—Ä–µ–∑ cron (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- ‚úÖ –î–∏—Å–∫ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω
- ‚úÖ –õ–æ–≥–∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤: 50 MB (5 —Ñ–∞–π–ª–æ–≤ √ó 10 MB)
- ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—Å—è

**–í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è: 2-5 –º–∏–Ω—É—Ç**

