# üé® –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –∞–ª—å–±–æ–º–æ–≤

## ‚ùå –ü—Ä–æ–±–ª–µ–º—ã –î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **–§–∞–π–ª—ã –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è**
   - –û—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –∫–∞–∫ `unnamed` (–±–µ–∑ `.jpg`)
   - Telegram –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–ª –∏—Ö –∫–∞–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

2. **–ê–ª—å–±–æ–º—ã —Ä–∞–∑–≤–∞–ª–∏–≤–∞–ª–∏—Å—å**
   - –ï—Å–ª–∏ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ –±—ã–ª–æ 2+ —Ñ–æ—Ç–æ, –æ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
   - –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `grouped_id` –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏

3. **Polling –≤–º–µ—Å—Ç–æ Event-based**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (–º–µ–¥–ª–µ–Ω–Ω–æ)
   - –ü—Ä–æ–ø—É—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–∏ –±—ã—Å—Ç—Ä—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö

---

## ‚úÖ –ß—Ç–æ –ò–°–ü–†–ê–í–õ–ï–ù–û:

### 1. Event-based –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```python
self.client.add_event_handler(
    self._new_message_handler,
    events.NewMessage(chats=self.source_entity)
)
```
- **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è** –Ω–∞ –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã
- –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –≤ 5 –º–∏–Ω—É—Ç
- –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ

### 2. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∞–ª—å–±–æ–º–æ–≤ –ø–æ `grouped_id`
```python
if group_id:
    if group_id not in self.groups:
        self.groups[group_id] = []
    
    self.groups[group_id].append(msg)
    
    # –¢–∞–π–º–µ—Ä –¥–ª—è —Å–±–æ—Ä–∞ –≤—Å–µ—Ö —Ñ–æ—Ç–æ –≤ –∞–ª—å–±–æ–º–µ
    timer = asyncio.create_task(self._flush_group_after_delay(group_id, delay=2.0))
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. Telegram –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –≤—Å–µ–º —Ñ–æ—Ç–æ –≤ –∞–ª—å–±–æ–º–µ –æ–¥–∏–Ω `grouped_id`
2. –ú—ã —Å–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `grouped_id` –≤ –±—É—Ñ–µ—Ä
3. –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã (–∫–æ–≥–¥–∞ –≤—Å–µ —Ñ–æ—Ç–æ –ø—Ä–∏—à–ª–∏) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≥—Ä—É–ø–ø—É —Ü–µ–ª–∏–∫–æ–º
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ–¥–Ω–∏–º –∞–ª—å–±–æ–º–æ–º

### 3. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
```python
# –î–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
await self.client.send_file(
    self.target_entity,
    BytesIO(photo_bytes),
    caption=text
)

# –ü–û–°–õ–ï (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
bio = BytesIO(photo_bytes)
bio.name = "photo.jpg"  # ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º –∏–º—è —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º!
bio.seek(0)
await self.client.send_file(
    self.target_entity,
    bio,
    caption=text
)
```

### 4. –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª—å–±–æ–º–æ–≤ –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
```python
# –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã
files = []
for idx, photo_bytes in enumerate(media_list):
    bio = BytesIO(photo_bytes)
    bio.name = f"photo_{idx + 1}.jpg"  # photo_1.jpg, photo_2.jpg, ...
    bio.seek(0)
    files.append(bio)

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –û–î–ò–ù —Ä–∞–∑ —Å –º–∞—Å—Å–∏–≤–æ–º —Ñ–∞–π–ª–æ–≤
await self.client.send_file(
    self.target_entity,
    files,  # ‚úÖ –ú–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ = –∞–ª—å–±–æ–º!
    caption=text
)
```

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:

### –î–æ:
```
–ò—Å—Ç–æ—á–Ω–∏–∫: [—Ñ–æ—Ç–æ1] [—Ñ–æ—Ç–æ2] [—Ñ–æ—Ç–æ3] + —Ç–µ–∫—Å—Ç

–í–∞—à –∫–∞–Ω–∞–ª:
- –ü–æ—Å—Ç 1: unnamed (—Ñ–æ—Ç–æ1)
- –ü–æ—Å—Ç 2: unnamed (—Ñ–æ—Ç–æ2)  
- –ü–æ—Å—Ç 3: unnamed (—Ñ–æ—Ç–æ3)
- –ü–æ—Å—Ç 4: —Ç–µ–∫—Å—Ç
```

### –ü–æ—Å–ª–µ:
```
–ò—Å—Ç–æ—á–Ω–∏–∫: [—Ñ–æ—Ç–æ1] [—Ñ–æ—Ç–æ2] [—Ñ–æ—Ç–æ3] + —Ç–µ–∫—Å—Ç

–í–∞—à –∫–∞–Ω–∞–ª:
- –ê–ª—å–±–æ–º: [photo_1.jpg] [photo_2.jpg] [photo_3.jpg] + —Ç–µ–∫—Å—Ç ‚úÖ
```

---

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. **–û–¥–∏–Ω–æ—á–Ω–æ–µ —Ñ–æ—Ç–æ:**
   ```
   ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∏–º–µ–Ω–µ–º photo.jpg
   ‚úÖ –ü–æ–¥–ø–∏—Å—å –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∞
   ```

2. **–ê–ª—å–±–æ–º (2+ —Ñ–æ—Ç–æ):**
   ```
   ‚úÖ –í—Å–µ —Ñ–æ—Ç–æ –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
   ‚úÖ –ò–º–µ–Ω–∞: photo_1.jpg, photo_2.jpg, ...
   ‚úÖ –ü–æ–¥–ø–∏—Å—å –ø–æ–¥ –∞–ª—å–±–æ–º–æ–º
   ```

3. **–¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç:**
   ```
   ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
   ```

---

## üöÄ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

1. –û–ø—É–±–ª–∏–∫—É–π—Ç–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–∞–Ω–∞–ª–µ:
   - –ê–ª—å–±–æ–º –∏–∑ 3 —Ñ–æ—Ç–æ —Å —Ç–µ–∫—Å—Ç–æ–º
   
2. –í –ª–æ–≥–∞—Ö —É–≤–∏–¥–∏—Ç–µ:
   ```
   üîî –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ID 1 (grouped_id: 123456789)
   üîî –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ID 2 (grouped_id: 123456789)
   üîî –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ID 3 (grouped_id: 123456789)
   üì¶ Flush –≥—Ä—É–ø–ø—ã 123456789: —Å–æ–±—Ä–∞–Ω–æ 3 —Å–æ–æ–±—â–µ–Ω–∏–π
   üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ª—å–±–æ–º–∞ ID 123456789 (3 –º–µ–¥–∏–∞)
   üé® –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è ID 1...
   üé® –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è ID 2...
   üé® –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è ID 3...
   üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª—å–±–æ–º–∞ (3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)...
   ‚úÖ –ê–ª—å–±–æ–º –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω (3 —Ñ–æ—Ç–æ)
   ‚úÖ –ê–ª—å–±–æ–º —É—Å–ø–µ—à–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω (3 –º–µ–¥–∏–∞)
   ```

3. –í –≤–∞—à–µ–º –∫–∞–Ω–∞–ª–µ –ø–æ—è–≤–∏—Ç—Å—è –∞–ª—å–±–æ–º (–Ω–µ 3 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è!)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

### `grouped_id`
- Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –≤—Å–µ–º —Ñ–æ—Ç–æ –≤ –∞–ª—å–±–æ–º–µ
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–ª—è –≤—Å–µ—Ö –º–µ–¥–∏–∞ –≤ –≥—Ä—É–ø–ø–µ
- `None` –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### –¢–∞–π–º–µ—Ä flush (2 —Å–µ–∫—É–Ω–¥—ã)
- –ù—É–∂–µ–Ω —á—Ç–æ–±—ã –¥–æ–∂–¥–∞—Ç—å—Å—è –≤—Å–µ—Ö —Ñ–æ—Ç–æ –≤ –∞–ª—å–±–æ–º–µ
- Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏
- –ï—Å–ª–∏ –ø—Ä–∏–¥–µ—Ç –µ—â–µ –æ–¥–Ω–æ —Ñ–æ—Ç–æ - —Ç–∞–π–º–µ—Ä —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è

### `bio.name = "photo.jpg"`
- –ë–µ–∑ —ç—Ç–æ–≥–æ Telegram –Ω–µ –∑–Ω–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞–∫ "unnamed" (generic file)
- –° –∏–º–µ–Ω–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

### `bio.seek(0)`
- –ü–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ BytesIO –∫—É—Ä—Å–æ—Ä –≤ –∫–æ–Ω—Ü–µ
- –ù—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –≤ –Ω–∞—á–∞–ª–æ –ø–µ—Ä–µ–¥ —á—Ç–µ–Ω–∏–µ–º
- –ò–Ω–∞—á–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª

---

## üí° –ë–æ–Ω—É—Å: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç!

–ï—Å–ª–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞ `t.me/old_channel`, –æ–Ω–∞ –∑–∞–º–µ–Ω–∏—Ç—Å—è –Ω–∞ `t.me/RynexNet_bot` (–≤–∞—à–∞ —Å—Å—ã–ª–∫–∞).

